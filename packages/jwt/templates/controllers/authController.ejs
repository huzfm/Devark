import bcrypt from "bcryptjs";
import { generateToken } from "../utils/jwtUtils.js";

const users = []; // Replace with DB in production

export const register = (req, res) => {
const { username, password } = req.body;
const hashedPassword = bcrypt.hashSync(password, 10);
users.push({ username, password: hashedPassword });
res.json({ message: "User registered successfully" });
};

export const login = (req, res) => {
const { username, password } = req.body;
const user = users.find(u => u.username === username);

if (!user || !bcrypt.compareSync(password, user.password)) {
return res.status(401).json({ error: "Invalid credentials" });
}

const token = generateToken({ username: user.username });
res.json({ token });
};

export const profile = (req, res) => {
res.json({ user: req.user });
};